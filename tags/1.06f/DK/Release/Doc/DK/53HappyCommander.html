<html><head><title>BeHappy Development kit</title></head>
<body bgcolor=#c0c0c0>
<h6 align="center"><center><a href="../4DK.html">Return to DK Summary</a></center></h6>
<hr>
<!DK><!class><!DK>
<a href="51Scripting.html"><center>Scripting</center></a><hr>
<a name="HappyCommander"><h1>HappyCommander</h1></a>
<p>Derived from: none
<p>Declared in: HappyCommander.h
<p>HappyCommander is an example class to show how to command BeHappy from an application,
to use it to display the documentation and help files.
<p>The source is free, you can modify it as you want, and include it in your application. 
This is just an example, you'll probably have to change a few things.

<hr>

<h2><font size=6>C</font>onstructor and <font size=6>D</font>estructor</h2>
<p><h3><a name="HappyCommander()">HappyCommander()</a></h3>

<Table> 
<tr> 
<td>&nbsp;&nbsp; 
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<tr> 
<td>&nbsp;&nbsp; 
<td><p>
  <Table cellpadding =3 bgcolor =eeeeee> 

  <tr><td> 
  <FONT  color=000022 size=+1><b><tt>HappyCommander(</tt></b></font><tt>const char</tt> *<font  color=991122 face=HELVETICA><i>addOnName</i></font>, <tt>const char</tt> *<font  color=991122 face=HELVETICA><i>addOnFileName</i></font>, <tt>const char</tt> *<font  color=991122 face=HELVETICA><i>htmlIndex</i></font><font  color=000022 size=+1><b><tt>)</tt></b></font>
  <p>
</table></table>

The constructor does nothing. It just copies the different names. 
<ul><li><font  color=991122 face=HELVETICA><i>addOnName</i></font> is the name of the 
add-on to use, as seen in BeHappy's 'Book' menu.
<li><font  color=991122 face=HELVETICA><i>addOnFileName</i></font> is the file name of 
the add-on. It doesn't have to be the same as <font  color=991122 face=HELVETICA><i>
addOnName</i></font>.
<li><font  color=991122 face=HELVETICA><i>htmlIndex</i></font> is the file name of the 
file to open if BeHappy isn't found.
</ul>

<p><hr>
<h3><a name="~HappyCommander()">~HappyCommander()</a></h3>

<Table> 
<tr> 
<td>&nbsp;&nbsp; 
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<tr> 
<td>&nbsp;&nbsp; 
<td><p>
  <Table cellpadding =3 bgcolor =eeeeee> 

  <tr><td> 
  <font  color=000022 size=+1><b><tt>~HappyCommander()</tt></b></font> 
  <p>
</table></table>

Destroys the <a href="53HappyCommander.html">HappyCommander</a>.

<p><hr>
<h2><font size=6>M</font>ember <font size=6>F</font>unctions</h2>

<p>
<h3><a name="InstallAddOn()">InstallAddOn()</a></h3>

<Table> 
<tr> 
<td>&nbsp;&nbsp; 
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<tr> 
<td>&nbsp;&nbsp; 
<td><p>
  <Table cellpadding =3 bgcolor =eeeeee> 

  <tr><td> 
  <tt>int</tt> <font  color=000022 size=+1><b><tt>InstallAddOn()</tt></b></font> 
  <p>
</table></table>

<p>Checks if the add-on is installed in BeHappy's add-on folder. If it isn't, an alert
box will open, asking if the user wants the add-on automaticaly installed. If he
says yes, the add-on is installed. For this function to work, the add-on must be
at first in the application's folder. Its name must be <font  color=991122 face=HELVETICA>
<i>addOnFileName</i></font>, as given to the <a href = "#HappyCommander()">HappyCommander()</a>
constructor. If the user wants it to be installed, it will simply be moved in 
BeHappy's add-on folder.
<p>It can return one of the following values:
<ul><li><tt>HappyCommander::HC_OK</tt> if the add-on was correctly installed
<li><tt>HappyCommander::HC_ALREADY_INSTALLED</tt> if it was already installed
<li><tt>HappyCommander::HC_REFUSED</tt> if the user didn't want it to be installed
<li><tt>HappyCommander::HC_NO_MORE_ASKING</tt> if the user didn't want it to be installed,
and didn't want to be asked anymore (you should save this with your preferences, to
avoid calling <a href="#InstallAddOn()">InstallAddOn()</a> the next time your application
is launched).
<li><tt>HappyCommander::HC_NO_ADDON</tt> if the add-on couldn't be found in the application's
folder.
<li><tt>HappyCommander::HC_NO_BEHAPPY</tt> if BeHappy couldn't be found
<li><tt>HappyCommander::HC_INSTALL_ERROR</tt> if another error occured
</ul>
This function should be called when your application starts. (In BApplication::ReadyToRun(),
as an example). This function doesn't launch BeHappy.

<p><hr>
<h3><a name="Show()">Show()</a></h3>

<Table> 
<tr> 
<td>&nbsp;&nbsp; 
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<tr> 
<td>&nbsp;&nbsp; 
<td><p>
  <Table cellpadding =3 bgcolor =eeeeee> 

  <tr><td> 
  <tt>int</tt> <font  color=000022 size=+1><b><tt>Show(</tt></b></font><tt>const 
   char</tt> *<font  color=991122 face=HELVETICA><i>index</i></font>
   <tt> = NULL</tt>, <tt>const char</tt> *<font  color=991122 face=HELVETICA><i>
   topic</i></font><tt> = NULL</tt><font  color=000022 size=+1><b><tt>)</tt></b></font> 
  <tr><td> 
  <tt>int</tt> <font  color=000022 size=+1><b><tt>Show(</tt></b></font><tt>const 
   char</tt> *<font  color=991122 face=HELVETICA><i>index</i></font>, <tt>const char</tt> *<font  color=991122 face=HELVETICA><i> fathertopic</i></font>, <tt>const char</tt> *<font  color=991122 face=HELVETICA><i> childtopic</i></font><font  color=000022 size=+1><b><tt>)</tt></b></font> 
  <p>
</table></table>

<p>Select a particular index and/or topic to show in BeHappy. The following actions
are performed:
<nl><li>If BeHappy isn't running, launch it
<li>If BeHappy hasn't any window opened, open one
<li>If the BeHappy window used by previous calls to <a href="#Show()">Show()</a> is
still there, select it. And if it isn't there anymore, open a new one
<li>Sets the selected BeHappy window to the correct book (<font  color=991122 face=HELVETICA>
<i>addOnName</i></font>, as given to the <a href="#HappyCommander">HappyCommander()</a>
constructor).
<li>Sets the window to the correct <font  color=991122 face=HELVETICA><i>index</i></font>
 (if <font  color=991122 face=HELVETICA><i>index</i></font> isn't <tt>NULL</tt>)
<li>Sets the window to the correct <font  color=991122 face=HELVETICA><i>topic</i></font>
 (if <font  color=991122 face=HELVETICA><i>topic</i></font> isn't <tt>NULL</tt>)
</nl>

<p>The second version can be used with indexes that have two lists. You can select the topic in the upper list with <font  color=991122 face=HELVETICA><i> fathertopic</i></font> and the one in the lower list with <font  color=991122 face=HELVETICA><i> childtopic</i></font><font  color=000022 size=+1>.
 
<p>It can return one of the following values:
<ul><li><tt>HappyCommander::HC_OK</tt> if the change was successfull
<li><tt>HappyCommander::HC_NO_BEHAPPY</tt> if BeHappy wasn't found. In that case, the
file <font  color=991122 face=HELVETICA><i>htmlIndex</i></font>, as given to the
<a href="#HappyCommander()">HappyCommander()</a> constructor, is opened instead.
<li><tt>HappyCommander::HC_OLD_BEHAPPY</tt> if the Behappy installed is a version
&lt; 1.02, which doesn't understands scripting. That means the BeHappy window may not
be at the correct book, index and/or topic.
<li><tt>HappyCommander::HC_NO_INDEX</tt> if the index wasn't found.
<li><tt>HappyCommander::HC_NO_TOPIC</tt> if the topic wasn't found
<li><tt>HappyCommander::HC_ERROR</tt> if another error occured (if the add-on has
disapeared, as an example)
</ul>

<p><hr>
<h3><a name="OpenHTMLIndex()">OpenHTMLIndex()</a></h3>

<Table> 
<tr> 
<td>&nbsp;&nbsp; 
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<tr> 
<td>&nbsp;&nbsp; 
<td><p>
  <Table cellpadding =3 bgcolor =eeeeee> 

  <tr><td> 
  <tt>void</tt> <font  color=000022 size=+1><b><tt>OpenHTMLIndex()</tt></b></font> 
  <p>
</table></table>

<p>Open the file <font  color=991122 face=HELVETICA><i>htmlIndex</i></font>, 
as given to the <a href="#HappyCommander()">HappyCommander()</a> constructor. This
function is called by <a href="#Show()">Show()</a> when BeHappy isn't found.<hr>
<h6 align="center"><center><a href="../4DK.html">Return to DK Summary</a></center></h6>
</body></html>